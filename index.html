<!doctype html><html lang=en-us><head><meta name=generator content="Hugo 0.79.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><title>Alex's Blog</title><link rel=stylesheet href=/xinba.github.io/css/style.css><link rel=stylesheet href=/xinba.github.io/css/fonts.css><link rel=icon href=favicon.ico><link rel=icon type=image/png sizes=32x32 href=/xinba.github.io/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/xinba.github.io/images/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/xinba.github.io/images/apple-touch-icon.png><link href=/xinba.github.io/index.xml rel=alternate type=application/rss+xml title="Alex's Blog"></head><body><nav class=nav><div class=nav-container><a href=/xinba.github.io/><h1 class=nav-title>Alex's Blog</h1></a><ul><li><a href=/xinba.github.io/posts><span>Posts</span></a></li></ul></div></nav><main><div class=catalogue><a href=https://xinbadev.github.io/xinba.github.io/posts/cloudflare/ class=catalogue-item><div><time datetime="2022-06-25 10:49:00 +1100 +1100" class=catalogue-time>June 25, 2022</time><h2 class=catalogue-title>关于前些天cloudflare事故的一些想法</h2><div class=catalogue-line></div><p>前几天下午cloudflare的网络出现了大事故，因为许多重要的网站都依赖cloudflare的网络，导致许多网站500无法访问，甚至连discord都一度无法正常使用。后来在twitter上看到消息，原来是cloudflare出了问题。隔天cloudflare就在我一直关注的官方博客上发布了事故报告，发布的速度和分析的详细都满足我对cloudflare这个公司的预期。这里主要是想记录一下我对这件事情的看法。</p></div></a><a href=https://xinbadev.github.io/xinba.github.io/posts/strapi-cms/ class=catalogue-item><div><time datetime="2022-05-28 11:12:22 +1100 +1100" class=catalogue-time>May 28, 2022</time><h2 class=catalogue-title>strapi-cms中deep filtering的问题</h2><div class=catalogue-line></div><p>最近在研究stapi-cms优化的时候看到console里面一个warning，&ldquo;Deep filtering queries should be used carefully (e.g Can cause performance issues). When possible build custom routes which will in most case be more optimised.&rdquo; 看到这个warningw我一开始是一头雾水的，于是打算调查一下。</p></div></a><a href=https://xinbadev.github.io/xinba.github.io/posts/grapqlloader/ class=catalogue-item><div><time datetime="2022-05-13 11:18:22 +1100 +1100" class=catalogue-time>May 13, 2022</time><h2 class=catalogue-title>strapi-cms中graphql插件优化的一些探索</h2><div class=catalogue-line></div><p>最近cms服务器又亮红灯了。虽然过去一年以来已经做了各种优化，比如增加缓存，减少对db的访问等，但是都只是短暂缓解，等资料量继续增加，问题又重新浮现。比如缓存失效后，一段时间内服务器会不堪重负，导致响应变慢，甚至当机。为了解决这个问题，前段时间把cms迁移到kubernetes上，使用多点部署，提高可用性。从用户体验上肯定会好很多，但是问题没有真正的解决，每天依然会有服务器变慢，甚至导致重启，而且因为autoscale费用提高等问题。我可以通过增加服务器的配置来减少这方面问题，但这样就又回到老路。必须要从代码层面进行优化了。</p></div></a><a href=https://xinbadev.github.io/xinba.github.io/posts/sql/ class=catalogue-item><div><time datetime="2021-06-13 19:33:00 +1100 +1100" class=catalogue-time>June 13, 2021</time><h2 class=catalogue-title>记一次对sql的调试和优化(Postgres query planner)</h2><div class=catalogue-line></div><p>最近在工作中碰到一个很有趣的sql问题。几乎同样的raw sql，最后执行出来的时间居然相差百倍不止。通过对这个问题的调试研究，对sql的执行过程（postgres）以及相应的优化有了更深的认识。</p></div></a><a href=https://xinbadev.github.io/xinba.github.io/posts/linux/ class=catalogue-item><div><time datetime="2020-12-21 16:50:11 +1100 +1100" class=catalogue-time>December 21, 2020</time><h2 class=catalogue-title>系统调用open时到底发生了什么？（Linux内核学习笔记）</h2><div class=catalogue-line></div><p>在计算中系统中，最重要的有三类资源，分别是cpu, memory, disk，他们也是编程语言经常需要打交道的三类资源。比如cpu对应了语言的并发性(例如GO以高并发著称)，memory则涉及到语言的垃圾回收的机制，disk则是涉及到创建文件/删除文件等。应该说相比前两者，disk的部分是相对简单的。以python为例，一个简单的打开/创建文件，写入“hello world”，然后关闭文件的程序代码如下：</p></div></a><a href=https://xinbadev.github.io/xinba.github.io/posts/goodarch/ class=catalogue-item><div><time datetime="2020-08-04 19:58:11 +1100 +1100" class=catalogue-time>August 4, 2020</time><h2 class=catalogue-title>什么是好的架构？</h2><div class=catalogue-line></div><p>使用AWS的云服务也有好几年了，最近在准备aws certified solution architect的考试。中间不仅对aws cloud的大大小小的功能系统的复习了一遍，同时也读了不少aws的白皮书。 这些天来一个问题又慢慢浮现在我的脑海中，挥之不去。到底什么是好的架构，或者说好的架构有什么特点？ 之前一直有在思考这方面的问题，也读过不少优秀的博客。印象中许多架构师的分享都是介绍如何利用各种框架技术实现高可用/高可靠性，高性能的服务。在大开眼界的同时，也给我一个感觉，只要掌握了各种优秀框架技术（适用场景以及利弊等）就可以作出好的架构。这次系统的看了aws的各种白皮书，让我又重新思考什么是好的架构，并且有了新的认识。</p></div></a><a href=https://xinbadev.github.io/xinba.github.io/posts/debug2/ class=catalogue-item><div><time datetime="2020-04-20 09:17:22 +1100 +1100" class=catalogue-time>April 20, 2020</time><h2 class=catalogue-title>记一次生产服务器debug(下)</h2><div class=catalogue-line></div><p>在上一篇我们分析服务器的异常情况，并对导致异常的原因有了一个初步的判断。但是我们漏掉了一个关键的线索没有具体的分析，那就是cpu steal time。</p></div></a><a href=https://xinbadev.github.io/xinba.github.io/posts/debug1/ class=catalogue-item><div><time datetime="2020-04-14 10:27:22 +1100 +1100" class=catalogue-time>April 14, 2020</time><h2 class=catalogue-title>记一次生产服务器debug(上)</h2><div class=catalogue-line></div><p><ol><li>17:18分，nginx的error日志里开始出现upstream 110 connection timeout的记录。2. 17:22分， netdata开始报警20min steal cpu = 18.2%， 并很快上升31.8%。 3. 17:27分， 群里开始有人报告相应服务不能访问。 4. 17:30分， 远程登录服务器后发现cpu使用率非常的高（主要是node server在占用），基本在80-100使用率，但是服务器的访问量并不高。</li></ol></p></div></a><a href=https://xinbadev.github.io/xinba.github.io/posts/performance/ class=catalogue-item><div><time datetime="2020-04-11 11:14:22 +1100 +1100" class=catalogue-time>April 11, 2020</time><h2 class=catalogue-title>关于服务优化的调研和思考</h2><div class=catalogue-line></div><p>最近某台服务器的cpu使用率一直居高不下，直接导致用户等待时间增加，用户体验明显变差。甚至还出现了服务器几乎当机的情况。所以想研究一下有没有办法通过代码层面优化的方式减少cpu的使用率。</p></div></a><a href=https://xinbadev.github.io/xinba.github.io/posts/fallocate/ class=catalogue-item><div><time datetime="2020-03-14 17:14:11 +1100 +1100" class=catalogue-time>March 14, 2020</time><h2 class=catalogue-title>Fallocate的那些事</h2><div class=catalogue-line></div><p>fallocate是linux中的一个system call，他的主要作用是分配硬盘区块（block allocation）。我最初接触到这个命令是在本地测试一个程序的bug，这个bug需要在硬盘满了的时候才会触发。当时的硬盘空间还绰绰有余，需要想个办法把它快速填满。我知道linux中有个叫dd的命令可以往硬盘里写入指定大小的文件，我之前创建swap的时候就是用这个命令。但是这个命令用于创建大文件来说太久了。于是我想起之前在stackoverflow看到的另一个命令fallocate。据介绍，这个命令比dd快的多。一用之下，果然如此。</p></div></a></div><div class=pagination><a href=/xinba.github.io/page/2/ class="right arrow">&#8594;</a>
<span>1</span></div></main><footer><span>&copy; <time datetime="2022-07-06 09:12:22.973764304 +0000 UTC m=+0.133942193">2022</time> Alex. Made with <a href=https://gohugo.io>Hugo</a> using the <a href=https://github.com/EmielH/tale-hugo/>Tale</a> theme.</span></footer></body></html>